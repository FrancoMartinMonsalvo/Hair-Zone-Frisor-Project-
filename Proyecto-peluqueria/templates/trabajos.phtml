<?php require_once 'header.phtml' ?>

<h2 class="text-center">Fichero de trabajos</h2>

<?php
$clientes = array(); // Arreglo para rastrear clientes y sus trabajos

foreach ($trabajos as $trabajo) {
    $cliente_id = $trabajo['cliente_id'];

    if (!isset($clientes[$cliente_id])) {
        // Si es la primera vez que encontramos a este cliente, inicializamos un registro
        $clientes[$cliente_id] = array(
            'nombre' => $trabajo['NombreCliente'],
            'trabajos' => array(),
        );
    }

    // Agregamos los detalles del trabajo al arreglo de trabajos para el cliente
    $clientes[$cliente_id]['trabajos'][] = array(
        'fecha' => $trabajo['fecha_trabajo'],
        'trabajo_realizado' => $trabajo['trabajo_realizado'],
        'descripcion' => $trabajo['descripcion'],
    );
}
?>

<?php foreach ($clientes as $cliente) : ?>
    <div class="card mb-3">
        <div class="card-body">
            <h5 class="card-title"><?php echo $cliente['nombre']; ?></h5>
            <ul class="list-group list-group-flush">
                <?php foreach ($cliente['trabajos'] as $trabajo) : ?>
                    <li class="list-group-item">
                        Fecha: <?php echo $trabajo['fecha']; ?><br>
                        Trabajo Realizado: <?php echo $trabajo['trabajo_realizado']; ?><br>
                        Descripci√≥n: <?php echo $trabajo['descripcion']; ?>
                    </li>
                <?php endforeach; ?>
            </ul>
        </div>
    </div>
<?php endforeach; ?>



<?php require_once 'footer.phtml' ?>